cmake_minimum_required(VERSION 3.27)
project(machine_prog_proj_2_yukon C)

set(CMAKE_C_STANDARD 17)

set(CMAKE_MODULE_PATH ${CMAKE_SOURCE_DIR}/cmake_modules)

set(SDL2_PATH                   C:/Users/tobia/dev/SDL2-2.30.2/x86_64-w64-mingw32)
set(SDL2_IMAGE_PATH             C:/Users/tobia/dev/SDL2_image-2.8.2/x86_64-w64-mingw32)
set(SDL2_TTF_PATH               C:/Users/tobia/dev/SDL2_ttf-2.22.0/x86_64-w64-mingw32)
 
find_package(SDL2 REQUIRED)
include_directories(${SDL2_INCLUDE_DIR})
find_package(SDL2_image REQUIRED)
include_directories(${SDL2_IMAGE_INCLUDE_DIRS})
find_package(SDL2_ttf REQUIRED)
include_directories(${SDL2_TTF_INCLUDE_DIRS})

include_directories(
        .
        src
        src/main
        src/main/model
        src/main/view
        src/main/view/console
        src/main/view/SDL
        src/main/utils
)

add_executable(yukon_console
        src/main/model/card_llist.c
        src/main/model/card_llist.h
        src/main/view/console/console_view.c
        src/main/view/console/console_view.h
        src/main/yukon_commands.c
        src/main/yukon_commands.h
        src/main/utils/utils.c
        src/main/utils/utils.h
        src/main/view/console/console_start.c)

add_executable(yukon_sdl
        src/main/model/card_llist.c
        src/main/model/card_llist.h
        src/main/view/console/console_view.c
        src/main/view/console/console_view.h
        src/main/yukon_commands.c
        src/main/yukon_commands.h
        src/main/utils/utils.c
        src/main/utils/utils.h
        src/main/view/SDL/sdl_defines.h
        src/main/view/SDL/sdl_gui.c
        src/main/view/SDL/sdl_gui.h
        src/main/view/SDL/sdl_start.c)
 
target_link_libraries(yukon_sdl ${SDL2_LIBRARY} ${SDL2_IMAGE_LIBRARIES} ${SDL2_TTF_LIBRARIES})

enable_testing()

add_executable(test_utils
        src/tests/utils/test_utils.c
        src/main/utils/utils.c
        src/main/utils/utils.h
        src/main/model/card_llist.c
        src/main/model/card_llist.h)
add_test(NAME test_utils COMMAND test_utils)

add_executable(test_card_llist
        src/tests/model/test_card_llist.c
        src/main/model/card_llist.c
        src/main/model/card_llist.h)
add_test(NAME test_card_llist COMMAND test_card_llist)
      
add_executable(test_console_view
        src/tests/view/test_console_view.c
        src/main/model/card_llist.c
        src/main/model/card_llist.h
        src/main/view/console/console_view.c
        src/main/view/console/console_view.h
        src/main/yukon_commands.c
        src/main/yukon_commands.h
        src/main/utils/utils.c
        src/main/utils/utils.h)
add_test(NAME test_console_view COMMAND test_console_view)

configure_file(${CMAKE_CURRENT_SOURCE_DIR}/src/tests/resources/test_load_cards_cards_1.txt 
        ${CMAKE_CURRENT_BINARY_DIR} COPYONLY)
add_executable(test_yukon_commands
        src/tests/test_yukon_commands.c
        src/main/model/card_llist.c
        src/main/model/card_llist.h
        src/main/yukon_commands.c
        src/main/yukon_commands.h
        src/main/utils/utils.c
        src/main/utils/utils.h)
add_test(NAME test_yukon_commands COMMAND test_yukon_commands)

